<%= hidden_field_tag :direction, params[:direction] %>
<%= hidden_field_tag :sort, params[:sort] %>
<div class="div_table">
  <% if @evaluations.length != 0 %>

    <div class="row head_row">
      <div class="col-md-3"><%= sortable "course_name", "Course Name" %></div>
      <div class="col-md-2"><%= sortable "course_num", "Course Number" %></div>
      <div class="col-md-3"><%= sortable "professors.name", "Professor Name" %></div>
      <div class="col-md-2"><%= sortable "course_score" %></div>
      <div class="col-md-2"><%= sortable "teacher_score" %></div>
    </div>
    <% @evaluations.each do |evaluation| %>
      <div class"outer-container">
        <div class="row course_eval_row">
          <div class="col-md-3"><%= evaluation.course.name %></div>
          <div class="col-md-2"><%= evaluation.course_num %></div>
          <div class="col-md-3">---</div>
          <div class="col-md-2"><%= evaluation.average_course_score.truncate(2) %></div>
          <div class="col-md-2"><%= evaluation.average_teacher_score.truncate(2) %></div>
        </div>
        <div class="professor_rows" style="display:none;">
          <% evaluation.get_professor_data.each do |profEval| %>
            <a href="#" data-toggle="modal" class="professor_row_link" data-chart-data="<%= profEval.get_semester_data.map {|i| [i.semester.name, i.average_course_score.to_s, i.average_teacher_score.to_s]} %>" data-chart-id="#chart-<%= evaluation.course_id %>-<%= profEval.professor_id %>" data-target="#modal-<%= evaluation.course_id %>-<%= profEval.professor_id %>">
              <div class="row professor_row">
                <div class="col-md-3"><%= evaluation.course.name %></div>
                <div class="col-md-2"><%= evaluation.course_num %></div>
                <div class="col-md-3"><%= profEval.professor.name %></div>
                <div class="col-md-2"><%= profEval.average_course_score.truncate(2) %></div>
                <div class="col-md-2"><%= profEval.average_teacher_score.truncate(2) %></div>
              </div>
            </a>
            <div class="modal fade" id="modal-<%= evaluation.course_id %>-<%= profEval.professor_id %>" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
              <div class="modal-dialog">
                <div class="modal-content">
                  <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h4 class="modal-title" id="myModalLabel"><%= profEval.professor.name %></h4>
                  </div>
                  <div class="modal-body">
                    <canvas id="chart-<%= evaluation.course_id %>-<%= profEval.professor_id %>" width="600" height="400"></canvas>
                  </div>
                  <div class="modal-footer">
                    <button type="button" class="btn btn-primary" data-dismiss="modal">Close</button>
                  </div>
                </div>
              </div>
            </div>
          <% end %>
        </div>
      </div>
    <%end %>
  <% end %>
</div>
<%= will_paginate @evaluations %>
